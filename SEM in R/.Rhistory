anova(lm.fit, lm.fit2)
names(Carseats)
lm.fit <- lm(Sales ~. + Income:Advertising+Price:Age, data=Carseats)
summary(lm.fit)
contrasts(Carseats$ShelveLoc)
print("The libraries have been loaded.")
LoadLibraries <- function(){
library(ISLR)
library(MASS)
print("The libraries have been loaded.")
}
LoadLibraries()
LoadLibraries <- function(){
library(ISLR)
library(MASS)
print("The libraries have been loaded.")
}
LoadLibraries()
summary(lm(mpg~horsepower, data=Auto))
abline(plot(Auto$mpg, Auto$horsepower))
lm.fit <- lm(mpg~horsepower, data=Auto)
summary(lm.fit)
abline(lm.fit)
plot(Auto$mpg, Auto$horsepower)
plot(Auto$mpg, Auto$horsepower, main = lm.fit)
plot(Auto$mpg, Auto$horsepower, main = "Horsepower vs MPG")
plot(Auto$mpg, Auto$horsepower, main = "Horsepower vs MPG")
abline(lm.fit, col="red")
lm.auto <- lm(mpg~horsepower, data=Auto)
summary(lm.auto)
plot(Auto$mpg, Auto$horsepower, main = "Horsepower vs MPG")
abline(lm.auto, col="red")
plot(Auto$horsepower, Auto$mpg, main = "Horsepower vs MPG")
plot(Auto$horsepower, Auto$mpg, main = "Horsepower vs MPG")
abline(lm.auto, col="red")
plot(lm.auto)
install.packages(c("openxlsx", "polspline", "ps", "scales", "tidygraph", "tidyr", "tidyselect", "vctrs"))
install.packages(c("backports", "ellipsis", "glmnet", "glue", "maptools", "mice", "polspline", "tidygraph", "tidyselect", "vctrs"))
install.packages(c("ellipsis", "glmnet", "maptools", "mice", "polspline"))
setwd("C:/Users/miqui/OneDrive/R Projects/SEM in R")
require(lavaan)
require(semPlot)
library(foreign)
library(tidyverse)
library(tidygraph)
library(ggraph)
library(dplyr)
db = file.choose()
dataset = read.spss(db, to.data.frame=TRUE)
attach(dataset)
#### Preprocessing ####
#dataset$MSA97 = as.character(datasetMSA97)
dataset$gender <- as.character(dataset$gender)
# Binarizing variables
dataset <- dataset %>%
mutate(GR = case_when(
gender == 0 & race == 1 ~ "01",
gender == 0 & race == 2 ~ "02",
gender == 0 & race == 3 ~ "03",
gender == 0 & race == 4 ~ "04",
gender == 1 & race == 1 ~ "11",
gender == 1 & race == 2 ~ "12",
gender == 1 & race == 3 ~ "13",
gender == 1 & race == 4 ~ "14"
))
table(dataset$GR)
dataset <- dataset %>%
mutate(Aincarceration = case_when(
adultincarceration == 0 ~ "0",
adultincarceration != 0 ~ "1"))
dataset <- dataset %>%
mutate(Jincarceration = case_when(
juvenileincarceration == 0 ~ "0",
juvenileincarceration != 0 ~ "1"))
dataset <- dataset %>%
mutate(ESuspend = case_when(
elementarysuspend == 0 ~ "0",
elementarysuspend >= 1 ~ "1"))
dataset <- dataset %>%
mutate(MSuspend = case_when(
middlesuspend == 0 ~ "0",
middlesuspend >= 1 ~ "1"
))
dataset <- dataset %>%
mutate(HSuspend = case_when(
highsuspend == 0 ~ "0",
highsuspend >= 1 ~ "1"))
attach(dataset)
variables <- as.data.frame(names(dataset))
mean(age)
ds <- function(X){
print(mean(X))
print(sd(X))
}
ds(age)
ds(highgrade15)
library(dplyr)
ds(elementarysuspend)
table(elementarysuspend)
ds(elementarysuspend)
ds(middlesuspend)
ds(highsuspend)
ds <- function(X){
round(print(mean(X)),3)
round(print(sd(X)),3)
}
ds(highsuspend)
ds <- function(X){
round(print(mean(X)),3)
round(print(sd(X)),3)
}
ds(highsuspend)
ds <- function(X){
print(round(mean(X)), 3)
print(round(sd(X)), 3)
}
ds(highsuspend)
ds <- function(X){
print(round(mean(X)), 3)
print(round(sd(X)), 3)
}
u
ds(highsuspend)
ds <- function(X){
print(round(mean(X), 3))
print(round(sd(X), 3))
}
ds(highsuspend)
ds(highsuspend)
ds(highgrade15)
ds(totalincarceration)
table(totalincarceration)
ds(totalincarceration)
ds(firstincarcerationage)
ds(Jincarceration)
ds(totalincarcemon)
ds(middleincarcemon)
ds(adultincarcemon)
table(adultincarcemon)
typeof(adultincarcemon)
ds(adultincarcemon)
lapply(variables, type_of)
lapply(variables, typeof)
for var in variables:
table(elementaryincarcemon)
ds(elementaryincarcemon)
ds(middleincarcemon)
typeof(elementaryincarcemon)
typeof(middleincarcemon)
table(middleincarcemon)
ds(middleincarmon)
ds(adultincarcemon)
table(adultincarcemon)
aim <- dataset %>%
select(adultincarcemon)
View(aim)
ds <- function(X){
print(round(mean(X, na.rm = TRUE), 3))
print(round(sd(X, na.rm = TRUE), 3))
}
ds(middleincarcemon)
ds(elementaryincarcemon)
ds(highincarcemon)
ds(adultincarcemon)
female <- dataset %>% filter(gender == 0)
male <- dataset %>% filter(gender == 1)
ds(female$age)
ds(juvenileincarceration)
ds(adultincarceration)
t.test(age)
t.test(age, gender)
library(dplyr)
group_by(dataset, gender) %>%
summarise(
count = n(),
mean = mean(weight, na.rm = TRUE),
sd = sd(weight, na.rm = TRUE)
)
group_by(dataset, gender) %>%
summarise(
count = n(),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE)
)
library(dplyr)
group_by(dataset, gender) %>%
summarise(
count = n(),
mean = round(mean(age, na.rm = TRUE),3),
sd = round(sd(age, na.rm = TRUE), 3)
)
library(dplyr)
group_by(dataset, gender) %>%
summarise(
count = n(),
mean = round(mean(age, na.rm = TRUE),
sd = round(sd(age, na.rm = TRUE))
)
asdf
library(dplyr)
group_by(dataset, gender) %>%
summarise(
count = n(),
mean = round(mean(age, na.rm = TRUE)),
sd = round(sd(age, na.rm = TRUE))
)
library(dplyr)
group_by(dataset, gender) %>%
summarise(
count = n(),
mean = round(mean(age, na.rm = TRUE), 3),
sd = sd(age, na.rm = TRUE)
)
group_by(dataset, GR) %>%
summarise(
count = n(),
mean = round(mean(age, na.rm = TRUE), 3),
sd = sd(age, na.rm = TRUE)
)
whiteFemale <- dataset %>%
filter(GR = "01")
whiteFemale <- dataset %>%
filter(GR == "01")
table(whiteFemale$GR)
blackFemale <- dataset %>%
filter(GR == "02")
hispFemale <- dataset %>%
filter(GR == "03")
otherFemale <- dataset %>%
filter(GR == "04")
whiteMale <- dataset %>%
filter(GR == "11")
blackMale <- dataset %>%
filter(GR == "12")
hispMale <- dataset %>%
filter(GR == "13")
otherMale <- dataset %>%
filter(GR == "14")
ds(whiteFemale$age)
ds(whiteFemale$elementarysuspend)
ds(whiteFemale$middlesuspend)
ds(whiteFemale$highsuspend)
ds(whiteFemale$highgrade15)
ds(whiteFemale$totalincarceration)
ds(whiteFemale$firstincarcerationage)
ds(whiteFemale$juvenileincarceration)
ds(whiteFemale$adultincarceration)
ds(whiteFemale$totalincarcemon)
ds(whiteFemale$firstincarcerationage)
ds(whiteFemale$adultincarceration)
ds(whiteFemale$totalincarcemon)
ds(whiteFemale$elementaryincarcemon)
ds(whiteFemale$middleincarcemon)
ds(whiteFemale$highincarcemon)
ds(whiteFemale$adultincarcemon)
ds(blackFemale$age)
ds(blackFemale$elementarysuspend)
ds(blackFemale$middlesuspend)
ds(blackFemale$highsuspend)
ds(blackFemale$highgrade15)
ds(blackFemale$totalincarceration)
ds(blackFemale$firstincarcerationage)
ds(blackFemale$juvenileincarceration)
ds(blackFemale$adultincarceration)
ds(blackFemale$totalincarcemon)
ds(blackFemale$elementaryincarcemon)
ds(blackFemale$middleincarcemon)
ds(blackFemale$highincarcemon)
ds(blackFemale$adultincarcemon)
# Variables
ds(blackFemale$age)
ds(blackFemale$elementarysuspend)
ds(blackFemale$middlesuspend)
ds(blackFemale$highsuspend)
ds(blackFemale$highgrade15)
ds(blackFemale$totalincarceration)
ds(blackFemale$firstincarcerationage)
ds(blackFemale$juvenileincarceration)
ds(blackFemale$adultincarceration)
ds(blackFemale$totalincarcemon)
ds(blackFemale$elementaryincarcemon)
ds(blackFemale$middleincarcemon)
ds(blackFemale$highincarcemon)
ds(blackFemale$adultincarcemon)
ds(hispFemale$age)
ds(hispFemale$elementarysuspend)
ds(hispFemale$middlesuspend)
ds(hispFemale$highsuspend)
ds(hispFemale$highgrade15)
ds(hispFemale$totalincarceration)
ds(hispFemale$firstincarcerationage)
ds(hispFemale$juvenileincarceration)
ds(hispFemale$adultincarceration)
ds(hispFemale$totalincarcemon)
ds(hispFemale$elementaryincarcemon)
ds(hispFemale$middleincarcemon)
ds(hispFemale$highincarcemon)
ds(hispFemale$adultincarcemon)
# Variables
ds(otherFemale$age)
ds(otherFemale$elementarysuspend)
ds(otherFemale$middlesuspend)
ds(otherFemale$highsuspend)
ds(otherFemale$highgrade15)
ds(otherFemale$totalincarceration)
ds(otherFemale$firstincarcerationage)
ds(otherFemale$juvenileincarceration)
ds(otherFemale$adultincarceration)
ds(otherFemale$totalincarcemon)
ds(otherFemale$elementaryincarcemon)
ds(otherFemale$middleincarcemon)
ds(otherFemale$highincarcemon)
ds(otherFemale$adultincarcemon)
table(otherFemale$firstincarcerationage)
ds(whiteMale$age)
ds(whiteMale$elementarysuspend)
ds(whiteMale$middlesuspend)
ds(whiteMale$highsuspend)
ds(whiteMale$highgrade15)
ds(whiteMale$totalincarceration)
ds(whiteMale$firstincarcerationage)
ds(whiteMale$juvenileincarceration)
ds(whiteMale$adultincarceration)
ds(whiteMale$totalincarcemon)
ds(whiteMale$elementaryincarcemon)
ds(whiteMale$middleincarcemon)
ds(whiteMale$highincarcemon)
ds(whiteMale$adultincarcemon)
# Variables
ds(blackMale$age)
ds(blackMale$elementarysuspend)
ds(blackMale$middlesuspend)
ds(blackMale$highsuspend)
ds(blackMale$highgrade15)
ds(blackMale$totalincarceration)
ds(blackMale$firstincarcerationage)
ds(blackMale$juvenileincarceration)
ds(blackMale$adultincarceration)
ds(blackMale$totalincarcemon)
ds(blackMale$elementaryincarcemon)
ds(blackMale$middleincarcemon)
ds(blackMale$highincarcemon)
ds(blackMale$adultincarcemon)
# Variables
ds(blackMale$age)
ds(blackMale$elementarysuspend)
ds(blackMale$middlesuspend)
ds(blackMale$highsuspend)
ds(blackMale$highgrade15)
ds(blackMale$totalincarceration)
ds(blackMale$firstincarcerationage)
ds(blackMale$juvenileincarceration)
ds(blackMale$adultincarceration)
ds(blackMale$totalincarcemon)
ds(blackMale$elementaryincarcemon)
ds(blackMale$middleincarcemon)
ds(blackMale$highincarcemon)
ds(blackMale$adultincarcemon)
ds(hispMale$age)
ds(hispMale$elementarysuspend)
ds(hispMale$middlesuspend)
ds(hispMale$highsuspend)
ds(hispMale$highgrade15)
ds(hispMale$totalincarceration)
ds(hispMale$firstincarcerationage)
ds(hispMale$juvenileincarceration)
ds(hispMale$adultincarceration)
ds(hispMale$totalincarcemon)
ds(hispMale$elementaryincarcemon)
ds(hispMale$middleincarcemon)
ds(hispMale$highincarcemon)
ds(hispMale$adultincarcemon)
ds(otherMale$age)
ds(otherMale$elementarysuspend)
ds(otherMale$middlesuspend)
ds(otherMale$highsuspend)
ds(otherMale$highgrade15)
ds(otherMale$totalincarceration)
ds(otherMale$firstincarcerationage)
ds(otherMale$juvenileincarceration)
ds(otherMale$adultincarceration)
ds(otherMale$totalincarcemon)
ds(otherMale$elementaryincarcemon)
ds(otherMale$middleincarcemon)
ds(otherMale$highincarcemon)
ds(otherMale$adultincarcemon)
female <- dataset %>% filter(gender == 0)
male <- dataset %>% filter(gender == 1)
t.test(female$age, male$age)
t.test(female$elementarysuspend, male$elementarysuspend)
t.test(female$middlesuspend, male$middlesuspend)
# Variables
t.test(female$middlesuspend, male$middlesuspend)
# Variables
t.test(female$middlesuspend, male$middlesuspend)
highsuspend
# Variables
t.test(female$highsuspend, male$highsuspend)
# Variables
t.test(female$highgrade15, male$highgrade15)
# Variables
t.test(female$firstincarcerationage, male$firstincarcerationage)
# Variables
t.test(female$firstincarcerationage, male$firstincarcerationage)
# Variables
t.test(female$totalincarceration, male$totalincarceration)
# Variables
t.test(female$juvenileincarceration, male$juvenileincarceration)
# Variables
t.test(female$adultincarceration, male$adultincarceration)
# Variables
t.test(female$totalincarcemon, male$totalincarcemon)
# Variables
t.test(female$elementaryincarcemon, male$elementaryincarcemon)
# Variables
t.test(female$middleincarcemon, male$middleincarcemon)
# Variables
t.test(female$highincarcemon, male$highincarcemon)
# Variables
t.test(female$adultincarcemon, male$adultincarcemon)
# Variables
t.test(dataset$age)
t.test(dataset$elementarysuspend)
t.test(dataset$middlesuspend)
t.test(dataset$highsuspend)
t.test(dataset$highgrade15)
t.test(dataset$firstincarcerationage)
t.test(dataset$totalincarceration)
t.test(dataset$juvenileincarceration)
t.test(dataset$adultincarceration)
t.test(dataset$totalincarcemon)
t.test(dataset$elementaryincarcemon)
t.test(dataset$middleincarcemon)
t.test(dataset$highincarcemon)
t.test(dataset$adultincarcemon)
table(gender, race)
prop.table(table(gender, race), margin = 1)
prop.table(table(gender, race), margin = 0)
prop.table(table(gender, race), margin = 2)
prop.table(table(gender, race), margin = 1)
round(prop.table(table(gender, race), margin = 1), 3)
table(gender, SES)
round(prop.table(table(gender, SES), margin = 1), 3)
table(gender, twoparenthome)
round(prop.table(table(gender, twoparenthome), margin = 1), 3)
round(prop.table(table(gender, twoparenthome), margin = 2), 3)
round(prop.table(table(gender, twoparenthome)), 3)
table(gender, gender)
round(prop.table(table(gender, gender)), 3)
round(prop.table(table(gender, gender), margin = 1), 3)
round(prop.table(table(gender, gender), margin = 2), 3)
round(prop.table(table(gender, gender), margin = 3), 3)
table(gender, gender)
round(prop.table(table(gender, gender), margin = 1), 3)
table(race, race)
table(gender, race)
table(race, gender)
round(prop.table(table(race, gender), margin = 1), 3)
table(SES, gender)
round(prop.table(table(SES, gender), margin = 1), 3)
table(twoparenthome, gender)
round(prop.table(table(twoparenthome, gender), margin = 1), 3)
table(citizenship, gender)
round(prop.table(table(citizenship, gender), margin = 1), 3)
table(geography97, gender)
table(geography97, gender)
round(prop.table(table(geography97, gender), margin = 1), 3)
table(elementsuspension, gender)
table(elementarysuspend, gender)
table(ESuspend, gender)
round(prop.table(table(ESuspend, gender), margin = 1), 3)
table(MSuspend, gender)
round(prop.table(table(MSuspend, gender), margin = 1), 3)
table(HSuspend, gender)
table(HSuspend, gender)
round(prop.table(table(HSuspend, gender), margin = 1), 3)
round(prop.table(table(HSuspend, gender), margin = 2), 3)
round(prop.table(table(HSuspend, gender), margin = 2), 3)
table(elementmiddledropout, gender)
table(elementmiddledropout, gender)
round(prop.table(table(elementmiddledropout, gender), margin = 2), 3)
table(highdropout, gender)
table(highdropout, gender)
round(prop.table(table(highdropout, gender), margin = 2), 3)
table(Jincarceration, gender)
,
table(Jincarceration, gender)
round(prop.table(table(Jincarceration, gender), margin = 2), 3)
table(Aincarceration, gender)
round(prop.table(table(Aincarceration, gender), margin = 2), 3)
table(race, gender)
round(prop.table(table(race, gender), margin = 2), 3)
round(prop.table(table(race, gender), margin = 2), 3)
round(prop.table(table(SES, gender), margin = 2), 3)
round(prop.table(table(twoparenthome, gender), margin = 2), 3)
round(prop.table(table(citizenship, gender), margin = 2), 3)
round(prop.table(table(geography97, gender), margin = 2), 3)
round(prop.table(table(ESuspend, gender), margin = 2), 3)
round(prop.table(table(MSuspend, gender), margin = 2), 3)
round(prop.table(table(HSuspend, gender), margin = 2), 3)
chisq.test(table(race, gender))
chisq.test(table(SES, gender))
chisq.test(table(twoparenthome, gender))
chisq.test(table(citizenship, gender))
chisq.test(table(geography97, gender))
chisq.test(table(ESuspend, gender))
chisq.test(table(MSuspend, gender))
chisq.test(table(HSuspend, gender))
chisq.test(table(elementmiddledropout, gender))
chisq.test(table(highdropout, gender))
chisq.test(table(Jincarceration, gender))
chisq.test(table(Aincarceration, gender))
